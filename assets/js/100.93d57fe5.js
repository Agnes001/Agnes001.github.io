(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{430:function(t,e,s){"use strict";s.r(e);var r=s(46),a=Object(r.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-init.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL C API Developer Guide"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"_1-mysql-init"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-mysql-init"}},[t._v("#")]),t._v(" 1. mysql_init()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"描述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),s("p",[t._v("分配或初始化一个"),s("code",[t._v("MYSQL")]),t._v("适合于的对象 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-real-connect.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_real_connect()")]),s("OutboundLink")],1),t._v("。如果 "),s("code",[t._v("mysql")]),t._v("是"),s("code",[t._v("NULL")]),t._v("指针，则函数分配、初始化并返回一个新对象。否则，初始化对象并返回对象的地址。如果 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-init.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_init()")]),s("OutboundLink")],1),t._v("分配了一个新对象，它会在"),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-close.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_close()")]),s("OutboundLink")],1),t._v("调用关闭连接时被释放 。")]),t._v(" "),s("p",[t._v("在非多线程环境中， 根据需要自动"),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-init.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_init()")]),s("OutboundLink")],1),t._v("调用 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-library-init.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_library_init()")]),s("OutboundLink")],1),t._v("。但是， "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-library-init.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_library_init()")]),s("OutboundLink")],1),t._v("在多线程环境中不是线程安全的，因此"),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-init.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_init()")]),s("OutboundLink")],1),t._v(". 在调用之前"),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-init.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_init()")]),s("OutboundLink")],1),t._v("，要么"),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-library-init.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_library_init()")]),s("OutboundLink")],1),t._v(" 在产生任何线程之前调用，要么使用互斥锁来保护 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-library-init.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_library_init()")]),s("OutboundLink")],1),t._v("调用。这应该在任何其他客户端库调用之前完成。")]),t._v(" "),s("h4",{attrs:{id:"返回值"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回值"}},[t._v("#")]),t._v(" 返回值")]),t._v(" "),s("p",[t._v("一个初始化的"),s("code",[t._v("MYSQL*")]),t._v("处理程序。 "),s("code",[t._v("NULL")]),t._v("如果没有足够的内存来分配新对象。")]),t._v(" "),s("h4",{attrs:{id:"错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#错误"}},[t._v("#")]),t._v(" 错误")]),t._v(" "),s("p",[t._v("如果内存不足，"),s("code",[t._v("NULL")]),t._v("则返回。")]),t._v(" "),s("h3",{attrs:{id:"_2-mysql-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-mysql-options"}},[t._v("#")]),t._v(" 2. mysql_options()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_options")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("enum")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("mysql_option")]),t._v(" option"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"描述-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述-2"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),s("p",[t._v("该"),s("code",[t._v("option")]),t._v("参数是你想要设置的选项; 该"),s("code",[t._v("arg")]),t._v("参数是选项的值。如果选项是整数，则指定一个指向整数值的指针作为"),s("code",[t._v("arg")]),t._v(" 参数。")]),t._v(" "),s("p",[t._v("下面的列表描述了可能的选项、它们的效果以及如何"),s("code",[t._v("arg")]),t._v("使用每个选项。对于指示"),s("code",[t._v("arg")]),t._v("未使用的选项描述 ，其值无关紧要；传0是惯例。")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("MYSQL_INIT_COMMAND")]),t._v("（参数类型： "),s("code",[t._v("char *")]),t._v("）")]),t._v(" "),s("p",[t._v("连接到 MySQL 服务器时要执行的 SQL 语句。如果发生重新连接，则自动重新执行。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("MYSQL_OPT_BIND")]),t._v("（说法："),s("code",[t._v("char *")]),t._v("）")]),t._v(" "),s("p",[t._v("连接到服务器的网络接口。当客户端主机有多个网络接口时使用。参数是主机名或 IP 地址（指定为字符串）。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("MYSQL_OPT_CONNECT_TIMEOUT")]),t._v("（参数类型："),s("code",[t._v("unsigned int *")]),t._v("）")]),t._v(" "),s("p",[t._v("以秒为单位的连接超时。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("MYSQL_OPT_MAX_ALLOWED_PACKET")]),t._v("（说法： "),s("code",[t._v("unsigned long *")]),t._v("）")]),t._v(" "),s("p",[t._v("此选项设置客户端/服务器通信缓冲区的客户端最大大小。如果 "),s("code",[t._v("mysql")]),t._v("参数是 non- "),s("code",[t._v("NULL")]),t._v("，则调用设置该会话的选项值。如果"),s("code",[t._v("mysql")]),t._v("是 "),s("code",[t._v("NULL")]),t._v("，则调用为所有未指定会话特定值的后续会话全局设置选项值。")]),t._v(" "),s("p",[t._v("因为可以设置会话或全局最大缓冲区大小，取决于 "),s("code",[t._v("mysql")]),t._v("参数是 non-"),s("code",[t._v("NULL")]),t._v("还是"),s("code",[t._v("NULL")]),t._v("， "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-get-option.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_get_option()")]),s("OutboundLink")],1),t._v(" 类似地根据其"),s("code",[t._v("mysql")]),t._v("参数返回会话或全局值。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("MYSQL_OPT_NET_BUFFER_LENGTH")]),t._v("（说法： "),s("code",[t._v("unsigned long *")]),t._v("）")]),t._v(" "),s("p",[t._v("此选项设置 TCP/IP 和套接字通信的客户端缓冲区大小。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("MYSQL_OPT_PROTOCOL")]),t._v("（参数类型： "),s("code",[t._v("unsigned int *")]),t._v("）")]),t._v(" "),s("p",[t._v("用于连接的传输协议。指定中"),s("code",[t._v("mysql_protocol_type")]),t._v(" 定义的枚举值之一"),s("code",[t._v("mysql.h")]),t._v("。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("MYSQL_OPT_READ_TIMEOUT")]),t._v("（参数类型： "),s("code",[t._v("unsigned int *")]),t._v("）")]),t._v(" "),s("p",[t._v("每次尝试从服务器读取的超时时间（以秒为单位）。必要时会重试，因此总有效超时值是选项值的三倍。您可以设置该值，以便在 TCP/IP"),s("code",[t._v("Close_Wait_Timeout")]),t._v("值 10 分钟之前检测到丢失的连接 。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("MYSQL_OPT_RECONNECT")]),t._v("（参数类型： "),s("code",[t._v("bool *")]),t._v("）")]),t._v(" "),s("p",[t._v("如果发现连接已丢失，则启用或禁用与服务器的自动重新连接。重新连接默认关闭；此选项提供了一种显式设置重新连接行为的方法。请参见 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/c-api-auto-reconnect.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("第 3.6.7 节，“自动重新连接控制”"),s("OutboundLink")],1),t._v("。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("MYSQL_OPT_RETRY_COUNT")]),t._v("（参数类型： "),s("code",[t._v("unsigned int *")]),t._v("）")]),t._v(" "),s("p",[t._v("在连接到服务器或与其通信时中断的 I/O 相关系统调用的重试计数。如果未指定此选项，则默认值为 1（如果初始调用中断 2 次，则重试 1 次）。")]),t._v(" "),s("p",[t._v("此选项只能由链接到使用 NDB Cluster 支持编译的 C 客户端库的客户端使用。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("MYSQL_OPT_WRITE_TIMEOUT")]),t._v("（参数类型： "),s("code",[t._v("unsigned int *")]),t._v("）")]),t._v(" "),s("p",[t._v("每次尝试写入服务器的超时时间（以秒为单位）。如有必要，会重试，因此总有效超时值是选项值的两倍。")])])]),t._v(" "),s("h4",{attrs:{id:"返回值-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回值-2"}},[t._v("#")]),t._v(" 返回值")]),t._v(" "),s("p",[t._v("成功为零。如果指定未知选项，则非零。")]),t._v(" "),s("h3",{attrs:{id:"_3-mysql-real-connect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-mysql-real-connect"}},[t._v("#")]),t._v(" 3. mysql_real_connect()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_real_connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("host"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("passwd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("unix_socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" client_flag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"描述-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述-3"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),s("p",[t._v("指定参数如下：")]),t._v(" "),s("ul",[s("li",[t._v("对于第一个参数，指定现有"),s("code",[t._v("MYSQL")]),t._v("结构的地址 。在调用之前 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-real-connect.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_real_connect()")]),s("OutboundLink")],1),t._v("，调用 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-init.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_init()")]),s("OutboundLink")],1),t._v("初始化"),s("code",[t._v("MYSQL")]),t._v("结构。")]),t._v(" "),s("li",[s("code",[t._v("host")]),t._v("可以是主机名或 IP 地址。")]),t._v(" "),s("li",[t._v("该"),s("code",[t._v("user")]),t._v("参数包含用户的 MySQL 登录 ID。如果"),s("code",[t._v("user")]),t._v("是 "),s("code",[t._v("NULL")]),t._v("或空字符串 "),s("code",[t._v('""')]),t._v("，则假定为当前用户。在 Unix 下，这是当前登录名。在 Windows ODBC 下，必须明确指定当前用户名。")]),t._v(" "),s("li",[t._v("该"),s("code",[t._v("passwd")]),t._v("参数包含 的密码"),s("code",[t._v("user")]),t._v("。如果 "),s("code",[t._v("passwd")]),t._v("是"),s("code",[t._v("NULL")]),t._v("，则仅检查"),s("code",[t._v("user")]),t._v("表中具有空白（空）密码字段的用户条目是否匹配。这使数据库管理员可以设置 MySQL 权限系统，使用户根据是否指定密码获得不同的权限。")]),t._v(" "),s("li",[s("code",[t._v("db")]),t._v("是数据库名称。如果 "),s("code",[t._v("db")]),t._v("不是"),s("code",[t._v("NULL")]),t._v("，则连接将默认数据库设置为此值。")]),t._v(" "),s("li",[t._v("如果"),s("code",[t._v("port")]),t._v("不为 0，则该值用作 TCP/IP 连接的端口号。请注意， "),s("code",[t._v("host")]),t._v("参数决定了连接的类型。")]),t._v(" "),s("li",[t._v("如果"),s("code",[t._v("unix_socket")]),t._v("不是 "),s("code",[t._v("NULL")]),t._v("，则字符串指定要使用的套接字或命名管道。请注意， "),s("code",[t._v("host")]),t._v("参数决定了连接的类型。")]),t._v(" "),s("li",[s("code",[t._v("client_flag")]),t._v("通常为 0")])]),t._v(" "),s("h4",{attrs:{id:"返回值-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回值-3"}},[t._v("#")]),t._v(" 返回值")]),t._v(" "),s("p",[t._v("一个"),s("code",[t._v("MYSQL*")]),t._v("连接处理程序，如果连接成功，"),s("code",[t._v("NULL")]),t._v("如果连接是不成功的。对于成功连接，返回值与第一个参数的值相同。")]),t._v(" "),s("h3",{attrs:{id:"_4-mysql-error"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-mysql-error"}},[t._v("#")]),t._v(" 4. mysql_error()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"描述-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述-4"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),s("p",[t._v("对于由 指定的连接"),s("code",[t._v("mysql")]),t._v("， "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-error.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_error()")]),s("OutboundLink")],1),t._v("返回一个以空字符结尾的字符串，其中包含最近调用失败的 API 函数的错误消息。如果函数没有失败，则返回值 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-error.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_error()")]),s("OutboundLink")],1),t._v("可能是前一个错误或空字符串表示没有错误。")]),t._v(" "),s("h4",{attrs:{id:"返回值-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回值-4"}},[t._v("#")]),t._v(" 返回值")]),t._v(" "),s("p",[t._v("描述错误的以空字符结尾的字符串。如果没有发生错误，则为空字符串。")]),t._v(" "),s("h3",{attrs:{id:"_5-mysql-stat"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-mysql-stat"}},[t._v("#")]),t._v(" 5. mysql_stat()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_stat")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"描述-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述-5"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),s("p",[t._v("返回包含类似于"),s("strong",[t._v("mysqladmin status")]),t._v(" 命令提供的信息的字符串。这包括以秒为单位的正常运行时间以及正在运行的线程、问题、重新加载和打开表的数量。")]),t._v(" "),s("h4",{attrs:{id:"返回值-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回值-5"}},[t._v("#")]),t._v(" 返回值")]),t._v(" "),s("p",[t._v("描述服务器状态的字符串。 "),s("code",[t._v("NULL")]),t._v("表示连接已经关闭。")]),t._v(" "),s("h3",{attrs:{id:"_6-mysql-close"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-mysql-close"}},[t._v("#")]),t._v(" 6. mysql_close()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"描述-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述-6"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),s("p",[t._v("关闭先前打开的连接。")]),t._v(" "),s("h3",{attrs:{id:"_7-mysql-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-mysql-query"}},[t._v("#")]),t._v(" 7. mysql_query()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_query")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("stmt_str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"描述-7"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述-7"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),s("p",[t._v("执行空终止字符串指向的 SQL 语句"),s("code",[t._v("stmt_str")]),t._v("。通常，字符串必须由单个 SQL 语句组成，没有终止分号 ( "),s("code",[t._v(";")]),t._v(") 或"),s("code",[t._v("\\g")]),t._v(". 如果启用了多语句执行，则字符串可以包含多个用分号分隔的语句。")]),t._v(" "),s("p",[t._v("要确定语句是否返回结果集，请调用 "),s("code",[t._v("mysql_field_count()")]),t._v("。")]),t._v(" "),s("h4",{attrs:{id:"返回值-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回值-6"}},[t._v("#")]),t._v(" 返回值")]),t._v(" "),s("p",[t._v("成功为零。如果发生错误，则非零。")]),t._v(" "),s("h3",{attrs:{id:"_8-mysql-store-result"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-mysql-store-result"}},[t._v("#")]),t._v(" 8. mysql_store_result()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("MYSQL_RES "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_store_result")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"描述-8"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述-8"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),s("p",[t._v("在调用mysql_query()或者mysql_real_query() 之后，须调用mysql_store_result()或者mysql_use_result() 对于那些成功检索了数据的每个查询（select,show,describe,explain,check table等）。\nmysql_store_result()将查询的全部结果读取到客户端，分配1个MYSQL_RES结构,并将结果置于该结构中。")]),t._v(" "),s("p",[t._v("调用mysql_num_rows()可以找出结果集中的行数。可以调用mysql_fetch_row()来获取结果集中的行，或调用mysql_row_seek()和mysql_row_tell()来获取或设置结果集中的当前行位置。")]),t._v(" "),s("p",[t._v("在对结果集处理完成之后，也必须调用mysql_free_result()函数释放内存。")]),t._v(" "),s("p",[t._v("要使用返回的结果集，需调用 "),s("code",[t._v("mysql_field_count()")]),t._v("。")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-store-result.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_store_result()")]),s("OutboundLink")],1),t._v("将查询的整个结果读取到客户端，分配一个 "),s("code",[t._v("MYSQL_RES")]),t._v("结构，并将结果放入该结构中。")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-store-result.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_store_result()")]),s("OutboundLink")],1),t._v("返回 "),s("code",[t._v("NULL")]),t._v("如果语句没有返回结果集（例如，如果它是一个 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/insert.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("INSERT")]),s("OutboundLink")],1),t._v("语句），或发生错误，结果集的读取失败。")]),t._v(" "),s("p",[t._v("如果没有返回行，则返回空结果集。（空结果集与作为返回值的空指针不同。）")]),t._v(" "),s("p",[t._v("在调用 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-store-result.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_store_result()")]),s("OutboundLink")],1),t._v("并取回非空指针的结果后，您可以调用 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-num-rows.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_num_rows()")]),s("OutboundLink")],1),t._v("以查明结果集中有多少行。")]),t._v(" "),s("p",[t._v("你可以调用"),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-fetch-row.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_fetch_row()")]),s("OutboundLink")],1),t._v(" 从结果集读取行，或者 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-row-seek.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_row_seek()")]),s("OutboundLink")],1),t._v("和 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-row-tell.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_row_tell()")]),s("OutboundLink")],1),t._v("获取或设置结果集中的当前行位置。")]),t._v(" "),s("h4",{attrs:{id:"返回值-7"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回值-7"}},[t._v("#")]),t._v(" 返回值")]),t._v(" "),s("p",[t._v("指向带有"),s("code",[t._v("MYSQL_RES")]),t._v("结果的结果结构的指针。"),s("code",[t._v("NULL")]),t._v("如果语句没有返回结果集或发生错误。要确定是否发生错误，请检查是 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-error.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_error()")]),s("OutboundLink")],1),t._v("返回非空字符串、"),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-errno.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_errno()")]),s("OutboundLink")],1),t._v(" 返回非零还是 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-field-count.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_field_count()")]),s("OutboundLink")],1),t._v("返回零。")]),t._v(" "),s("h3",{attrs:{id:"_9-mysql-field-count"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-mysql-field-count"}},[t._v("#")]),t._v(" 9. mysql_field_count()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_field_count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"描述-9"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述-9"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),s("p",[t._v("此函数的正常使用是在 "),s("code",[t._v("mysql_store_result()")]),t._v("返回时 "),s("code",[t._v("NULL")]),t._v("（因此您没有结果集指针）。在这种情况下，您可以调用 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-field-count.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_field_count()")]),s("OutboundLink")],1),t._v("以确定是否 "),s("a",{attrs:{href:"https://dev.mysql.com/doc/c-api/8.0/en/mysql-store-result.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("mysql_store_result()")]),s("OutboundLink")],1),t._v("应该产生非空结果。这使客户端程序能够在不知道查询是否是"),s("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/select.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("SELECT")]),s("OutboundLink")],1),t._v("（或 类似"),s("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/select.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("SELECT")]),s("OutboundLink")],1),t._v("）语句的情况下采取适当的操作。")]),t._v(" "),s("h4",{attrs:{id:"返回值-8"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回值-8"}},[t._v("#")]),t._v(" 返回值")]),t._v(" "),s("p",[t._v("一个无符号整数，表示结果集中的列数。")]),t._v(" "),s("h3",{attrs:{id:"_10-mysql-affected-rows"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_10-mysql-affected-rows"}},[t._v("#")]),t._v(" 10. mysql_affected_rows()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("uint64_t\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_affected_rows")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("它返回改变，删除或插入的最后一条语句的行数，如果它是一个"),s("code",[t._v("UPDATE")]),t._v("， "),s("code",[t._v("DELETE")]),t._v("或 "),s("code",[t._v("INSERT")]),t._v("。对于 "),s("code",[t._v("SELECT")]),t._v("语句， "),s("code",[t._v("mysql_affected_rows()")]),t._v("像"),s("code",[t._v("mysql_num_rows()")])]),t._v(" "),s("div",{staticClass:"language-c++ extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('if (mysql_query(mysql, sql.c_str()))\n{\n    LOG4CPLUS_ERROR(_logger, "SQL: "<<sql);\n    LOG4CPLUS_ERROR(_logger, "Query Error: "<<mysql_error(mysql));\n}\nelse\n{\n    result = mysql_store_result(mysql);\n    if (result)  //执行的是select show等语句\n    {\n        mysql_free_result(result);\n    }\n    else  // resutl == null\n    {\n        if(mysql_field_count(mysql) == 0)  //代表执行的是update,insert,delete类的非查询语句\n        {\n            res = mysql_affected_rows(mysql);\n        }\n    }\n}\n')])])]),s("h3",{attrs:{id:"_11-mysql-fetch-row"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_11-mysql-fetch-row"}},[t._v("#")]),t._v(" 11. mysql_fetch_row()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("MYSQL_ROW\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_fetch_row")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL_RES "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("检索结果集的下一行")]),t._v(" "),s("h3",{attrs:{id:"_12-mysql-free-result"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_12-mysql-free-result"}},[t._v("#")]),t._v(" 12. mysql_free_result()")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mysql_free_result")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MYSQL_RES "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("code",[t._v("mysql_free_result()")]),t._v("释放由"),s("code",[t._v("mysql_store_result()")]),t._v("、 "),s("code",[t._v("mysql_use_result()")]),t._v("、 "),s("code",[t._v("mysql_list_dbs()")]),t._v("等为结果集分配的内存 。处理完结果集后，您必须通过调用 来释放它使用的内存 "),s("code",[t._v("mysql_free_result()")]),t._v("。")]),t._v(" "),s("p",[t._v("在释放结果集后不要尝试访问它。")])])}),[],!1,null,null,null);e.default=a.exports}}]);